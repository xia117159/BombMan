#ifndef _D3DCLASS_H_
#define _D3DCLASS_H_

#include "include.h"

template<class Interface>
inline void
SafeRelease(
    Interface **ppInterfaceToRelease
    )
{
    if (*ppInterfaceToRelease != NULL)
    {
        (*ppInterfaceToRelease)->Release();

        (*ppInterfaceToRelease) = NULL;
    }
}

class D3DCLASS
{
    public:
        D3DCLASS();
        ~D3DCLASS();

		HRESULT CreateDeviceIndependentResources();
        bool Initialize( HINSTANCE hInstance, HWND hwnd );
        void Shutdown( );

		bool CompileD3DShader( LPCWSTR filePath, char* entry, char* shaderModel, ID3DBlob** buffer );

        virtual bool LoadContent(HWND hwnd);
        virtual void UnloadContent( );

        virtual void Update( float dt );
        virtual void Render( );

    protected:
        HINSTANCE hInstance_;
        HWND hwnd_;

        D3D_DRIVER_TYPE driverType_;
        D3D_FEATURE_LEVEL featureLevel_;

        ID3D11Device* d3dDevice_;
        ID3D11DeviceContext* d3dContext_;
        IDXGISwapChain* swapChain_;
        ID3D11RenderTargetView* backBufferTarget_;
		ID2D1Factory *pD2DFactory_; //所有根工厂接口
		ID2D1RenderTarget *pRT_;
		ID3D11DepthStencilView* depthStencilView_; //表示深度/模板视图
		ID3D11Texture2D* depthTexture_;

		LPDIRECTINPUT8 directInput_;
        
        LPDIRECTINPUTDEVICE8 keyboardDevice_; //键盘设备
		char keyboardKeys_[256];      //目前键盘按键
        char prevKeyboardKeys_[256];  //之前键盘按键

        LPDIRECTINPUTDEVICE8 mouseDevice_;//鼠标设备
        DIMOUSESTATE mouseState_;     //目前鼠标状态
        DIMOUSESTATE prevMouseState_; //之前鼠标状态
        long mousePosX_;  //鼠标x坐标
        long mousePosY_;  //鼠标y坐标
        long mouseWheel_; //滚轮
};

#endif